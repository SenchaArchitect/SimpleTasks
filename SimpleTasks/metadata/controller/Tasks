{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "Tasks",
        "models": [
            "Task"
        ],
        "stores": [
            "Tasks"
        ],
        "views": [
            "tasks.Grid",
            "tasks.Form",
            "tasks.EditWindow",
            "tasks.DefaultTimeWindow",
            "tasks.ReminderWindow",
            "tasks.ContextMenu"
        ]
    },
    "designerId": "b94139bd-3865-464a-a8d8-dc7150599f22",
    "cn": [
        {
            "type": "fixedfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "application"
                ],
                "fn": "init",
                "implHandler": [
                    " /* Workaround for inablity to add xtype */",
                    "    var refs = [",
                    "        {",
                    "            ref: 'listTree',",
                    "            selector: 'listTree'",
                    "        },",
                    "        {",
                    "            ref: 'taskForm',",
                    "            selector: 'taskForm'",
                    "        },",
                    "        {",
                    "            ref: 'taskGrid',",
                    "            selector: 'taskGrid'",
                    "        },",
                    "        {",
                    "            ref: 'tasksToolbar',",
                    "            selector: 'tasksToolbar'",
                    "        },",
                    "        {",
                    "            ref: 'taskEditWindow',",
                    "            selector: 'taskEditWindow',",
                    "            xtype: 'taskEditWindow',",
                    "            autoCreate: true",
                    "        },",
                    "        {",
                    "            ref: 'defaultTimeWindow',",
                    "            selector: 'defaultTimeWindow',",
                    "            xtype: 'defaultTimeWindow',",
                    "            autoCreate: true",
                    "        },",
                    "        {",
                    "            ref: 'reminderWindow',",
                    "            selector: 'reminderWindow',",
                    "            xtype: 'reminderWindow',",
                    "            forceCreate: true",
                    "        },",
                    "        {",
                    "            ref: 'contextMenu',",
                    "            selector: 'tasksContextMenu',",
                    "            xtype: 'tasksContextMenu',",
                    "            autoCreate: true",
                    "        }",
                    "    ];",
                    "",
                    "    this.ref(refs); // internal function",
                    "/* End workaround */",
                    "",
                    "    this.initReminderInterval();"
                ]
            },
            "designerId": "808e9941-d352-4002-b37e-7734074eee49"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "taskForm textfield",
                "designer|targetType": "Ext.form.field.Text",
                "fn": "handleSpecialKey",
                "implHandler": [
                    " if(e.getKey() === e.ENTER) {",
                    "            this.newTask();",
                    "        }"
                ],
                "name": "specialkey",
                "scope": "me"
            },
            "designerId": "fb1ae15f-9f7a-4fb3-a83a-5a56b7622df3"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "[iconCls=tasks-new]",
                "designer|params": [
                    "component",
                    "e"
                ],
                "designer|targetType": "Ext.Component",
                "fn": "focusTaskForm",
                "implHandler": [
                    "this.getTaskForm().query('[name=title]')[0].focus();"
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "869280bb-5d8b-4f5a-885d-6f4619b3780b"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#delete-task-btn",
                "designer|targetType": "Ext.button.Button",
                "fn": "handleDeleteClick",
                "implHandler": [
                    "        this.deleteTask(this.getTaskGrid().getSelectionModel().getSelection()[0]);",
                    ""
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "3007f463-275e-4ab8-9fa2-2c216f88f105"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#delete-task-item",
                "designer|targetType": "Ext.button.Button",
                "fn": "handleDeleteTaskItemClick",
                "implHandler": [
                    "this.handleDeleteClick(button, e, eOpts);"
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "02e58766-0a1b-4491-9391-13c8564e439f"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#mark-complete-item",
                "designer|targetType": "Ext.button.Button",
                "fn": "markComplete",
                "implHandler": [
                    "   var contextMenu = this.getContextMenu(),",
                    "            task = contextMenu.isVisible() ? contextMenu.getTask() : this.getTaskGrid().getSelectionModel().getSelection()[0];",
                    "",
                    "        task.set('done', true);",
                    "        task.set('reminder', null);",
                    "        task.save({",
                    "            failure: function(task, operation) {",
                    "                var error = operation.getError(),",
                    "                    msg = Ext.isObject(error) ? error.status + ' ' + error.statusText : error;",
                    "",
                    "                Ext.MessageBox.show({",
                    "                    title: 'Mark Complete Failed',",
                    "                    msg: msg,",
                    "                    icon: Ext.Msg.ERROR,",
                    "                    buttons: Ext.Msg.OK",
                    "                });",
                    "            }",
                    "        });",
                    "        this.refreshFiltersAndCount();"
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "ed38cfbb-9dd6-4fad-99b3-74e2c2d811c6"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#mark-complete-btn",
                "designer|targetType": "Ext.button.Button",
                "fn": "markCompleteButton",
                "implHandler": [
                    "this.markComplete(button, e, eOpts);"
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "1a6de13c-2c81-4878-aa39-861b44f12b37"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#mark-active-item",
                "designer|targetType": "Ext.button.Button",
                "fn": "markActive",
                "implHandler": [
                    "    var contextMenu = this.getContextMenu(),",
                    "            task = contextMenu.isVisible() ? contextMenu.getTask() : this.getTaskGrid().getSelectionModel().getSelection()[0];",
                    "",
                    "        task.set('done', false);",
                    "        task.save({",
                    "            failure: function(task, operation) {",
                    "                var error = operation.getError(),",
                    "                    msg = Ext.isObject(error) ? error.status + ' ' + error.statusText : error;",
                    "",
                    "                Ext.MessageBox.show({",
                    "                    title: 'Mark Active Failed',",
                    "                    msg: msg,",
                    "                    icon: Ext.Msg.ERROR,",
                    "                    buttons: Ext.Msg.OK",
                    "                });",
                    "            }",
                    "        });",
                    "        this.refreshFiltersAndCount();"
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "006d0e3e-3b87-419c-a54e-6c774a68d807"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#mark-active-btn",
                "designer|targetType": "Ext.button.Button",
                "fn": "markActiveButton",
                "implHandler": [
                    "this.markActive(button, e, eOpts);"
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "6bddb6c3-7003-46c8-9662-03e24381b97e"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#show-all-btn",
                "designer|targetType": "Ext.button.Button",
                "fn": "filterAll",
                "implHandler": [
                    "var tasksStore = this.getTasksStore(),",
                    "            filters = tasksStore.filters.getRange(0, tasksStore.filters.getCount() - 1),",
                    "            filterCount = filters.length,",
                    "            i = 0;",
                    "",
                    "        if(button.pressed) {",
                    "            tasksStore.clearFilter();",
                    "            for(; i < filterCount; i++) {",
                    "                if(filters[i].property === 'done') {",
                    "                    filters.splice(i, 1);",
                    "                    filterCount --;",
                    "                }",
                    "            }",
                    "            tasksStore.filter(filters);",
                    "        } else {",
                    "            button.toggle();",
                    "        } "
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "cee4863e-b089-4323-9970-3648a041580f"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#show-active-btn",
                "designer|targetType": "Ext.button.Button",
                "fn": "filterActive",
                "implHandler": [
                    "var tasksStore = this.getTasksStore(),",
                    "            filters = tasksStore.filters.getRange(0, tasksStore.filters.getCount() - 1),",
                    "            filterCount = filters.length,",
                    "            i = 0;",
                    "",
                    "        if(button.pressed) {",
                    "            tasksStore.clearFilter();",
                    "            for(; i < filterCount; i++) {",
                    "                if(filters[i].property === 'done') {",
                    "                    filters.splice(i, 1);",
                    "                    filterCount --;",
                    "                }",
                    "            }",
                    "            filters.push({ property: 'done', value: false });",
                    "            this.getTasksStore().filter(filters);",
                    "        } else {",
                    "            button.toggle();",
                    "        } "
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "36f38cfe-aaf6-420c-a575-36a373df4c43"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#show-complete-btn",
                "designer|targetType": "Ext.button.Button",
                "fn": "filterComplete",
                "implHandler": [
                    "   var tasksStore = this.getTasksStore(),",
                    "            filters = tasksStore.filters.getRange(0, tasksStore.filters.getCount() - 1),",
                    "            filterCount = filters.length,",
                    "            i = 0;",
                    "",
                    "        if(button.pressed) {",
                    "            tasksStore.clearFilter();",
                    "            for(; i < filterCount; i++) {",
                    "                if(filters[i].property === 'done') {",
                    "                    filters.splice(i, 1);",
                    "                    filterCount --;",
                    "                }",
                    "            }",
                    "            filters.push({ property: 'done', value: true });",
                    "            this.getTasksStore().filter(filters);",
                    "        } else {",
                    "            button.toggle();",
                    "        } "
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "c9fb61f5-9a1a-49d6-b910-1ccab32274c7"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#edit-task-item",
                "designer|targetType": "Ext.button.Button",
                "fn": "handleEditItemClick",
                "implHandler": [
                    "this.showEditWindow(this.getContextMenu().getTask());"
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "5cf261d7-9311-4110-b711-02638ae08b65"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "taskGrid",
                "designer|params": [
                    "task"
                ],
                "designer|targetType": null,
                "fn": "updateTask",
                "implHandler": [
                    "var me = this;",
                    "",
                    "if(task.modified.done === false) {",
                    "    task.set('reminder', null);",
                    "}",
                    "task.save({",
                    "    success: function(task, operation) {",
                    "        me.refreshFiltersAndCount();",
                    "        me.getTasksStore().sort();",
                    "    },",
                    "    failure: function(task, operation) {",
                    "        var error = operation.getError(),",
                    "            msg = Ext.isObject(error) ? error.status + ' ' + error.statusText : error;",
                    "",
                    "        Ext.MessageBox.show({",
                    "            title: 'Update Task Failed',",
                    "            msg: msg,",
                    "            icon: Ext.Msg.ERROR,",
                    "            buttons: Ext.Msg.OK",
                    "        });",
                    "    }",
                    "});"
                ],
                "name": "recordedit",
                "scope": "me"
            },
            "designerId": "2874ce3f-477c-418e-b459-3b3ff4717c12"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "taskGrid",
                "designer|params": [
                    "gridView",
                    "rowIndex",
                    "colIndex",
                    "column",
                    "e"
                ],
                "designer|targetType": null,
                "fn": "handleDeleteIconClick",
                "implHandler": [
                    "this.deleteTask(this.getTasksStore().getAt(rowIndex));"
                ],
                "name": "deleteclick",
                "scope": "me"
            },
            "designerId": "18c779a6-013e-4ac7-a362-fda47658bf05"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "taskGrid",
                "designer|params": [
                    "view",
                    "rowIndex",
                    "colIndex",
                    "column",
                    "e"
                ],
                "fn": "handleEditIconClick",
                "implHandler": [
                    "this.showEditWindow(view.getRecord(view.findTargetByEvent(e)));"
                ],
                "name": "editclick",
                "scope": "me"
            },
            "designerId": "e8c0a787-2810-4167-8fdb-ee446f8ce069"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "taskGrid",
                "designer|params": [
                    "task",
                    "value"
                ],
                "fn": "setReminder",
                "implHandler": [
                    "var me = this,",
                    "    defaultTimeWindow = me.getDefaultTimeWindow(),",
                    "    defaultTimeField = defaultTimeWindow.down('form').getForm().findField('default_time'),",
                    "    defaultTimeDate, defaultTimeMilliseconds;",
                    "",
                    "me.getDefaultReminderTime(function(defaultTime) {",
                    "    if(value === 'set') {",
                    "        // if the user selected \"Set Default Time\", show the default time window.",
                    "        defaultTimeField.setValue(defaultTime);",
                    "        defaultTimeWindow.show();",
                    "    } else {",
                    "        if(Ext.isNumber(value)) {",
                    "            // if the user selected a reminder time, set the reminder by adding the user selected value to the due date",
                    "            defaultTimeDate = Ext.Date.parse(defaultTime, defaultTimeField.format);",
                    "            defaultTimeMilliseconds = defaultTimeDate - Ext.Date.clearTime(defaultTimeDate, true);",
                    "            task.set('reminder', new Date(task.get('due').getTime() - (value * 86400000) + defaultTimeMilliseconds));",
                    "        } else {",
                    "            // if the user selected \"No Reminder\" set the reminder field to null",
                    "            task.set('reminder', null);",
                    "        }",
                    "        task.save({",
                    "            failure: function(task, operation) {",
                    "                var error = operation.getError(),",
                    "                    msg = Ext.isObject(error) ? error.status + ' ' + error.statusText : error;",
                    "",
                    "                Ext.MessageBox.show({",
                    "                    title: 'Set Reminder Failed',",
                    "                    msg: msg,",
                    "                    icon: Ext.Msg.ERROR,",
                    "                    buttons: Ext.Msg.OK",
                    "                });",
                    "            }",
                    "        });",
                    "    }",
                    "});"
                ],
                "name": "reminderselect",
                "scope": "me"
            },
            "designerId": "1a762ff5-8266-4718-b9ed-a198b473918e"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "taskGrid",
                "designer|params": [
                    "view",
                    "task",
                    "node",
                    "rowIndex",
                    "e"
                ],
                "fn": "showActions",
                "implHandler": [
                    "        var icons = Ext.DomQuery.select('.x-action-col-icon', node);",
                    "        Ext.each(icons, function(icon){",
                    "            Ext.get(icon).removeCls('x-hidden');",
                    "        });"
                ],
                "name": "itemmouseenter",
                "scope": "me"
            },
            "designerId": "6f59ca6b-3729-420a-b1ea-6eee6fc59b04"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "taskGrid",
                "designer|params": [
                    "view",
                    "task",
                    "node",
                    "rowIndex",
                    "e"
                ],
                "fn": "hideActions",
                "implHandler": [
                    "   var icons = Ext.DomQuery.select('.x-action-col-icon', node);",
                    "        Ext.each(icons, function(icon){",
                    "            Ext.get(icon).addCls('x-hidden');",
                    "        });"
                ],
                "name": "itemmouseleave",
                "scope": "me"
            },
            "designerId": "13217641-35b8-4ad1-9f2d-fe46e9296272"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "taskGrid",
                "designer|params": [
                    "selModel",
                    "tasks"
                ],
                "fn": "toggleButtons",
                "implHandler": [
                    "       var deleteTaskBtn = Ext.getCmp('delete-task-btn'),",
                    "            markCompleteBtn = Ext.getCmp('mark-complete-btn'),",
                    "            markActiveBtn = Ext.getCmp('mark-active-btn');",
                    "",
                    "        if(tasks.length === 0) {",
                    "            deleteTaskBtn.disable();",
                    "            markCompleteBtn.disable();",
                    "            markActiveBtn.disable();",
                    "        } else {",
                    "            deleteTaskBtn.enable();",
                    "            markCompleteBtn.enable();",
                    "            markActiveBtn.enable();",
                    "        }"
                ],
                "name": "selectionchange",
                "scope": "me"
            },
            "designerId": "5049b96d-d850-4cd3-8725-1985c9c334bb"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "taskGrid",
                "designer|params": [
                    "headerContainer",
                    "column",
                    "width"
                ],
                "fn": "syncTaskFormFieldWidth",
                "implHandler": [
                    "        var field = this.getTaskForm().query('[name=' + column.dataIndex + ']')[0];",
                    "        if (field) {",
                    "            field.setWidth(width - 5);",
                    "        }"
                ],
                "name": "columnresize",
                "scope": "me"
            },
            "designerId": "657c7f3e-8bd2-40a2-acb4-1d5c6b514075"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "taskGrid",
                "designer|params": [
                    "view",
                    "task",
                    "node",
                    "rowIndex",
                    "e"
                ],
                "designer|targetType": "Ext.Component",
                "fn": "showContextMenu",
                "implHandler": [
                    "     var contextMenu = this.getContextMenu(),",
                    "            markCompleteItem = Ext.getCmp('mark-complete-item'),",
                    "            markActiveItem = Ext.getCmp('mark-active-item');",
                    "",
                    "        if(task.get('done')) {",
                    "            markCompleteItem.hide();",
                    "            markActiveItem.show();",
                    "        } else {",
                    "            markCompleteItem.show();",
                    "            markActiveItem.hide();",
                    "        }",
                    "        contextMenu.setTask(task);",
                    "        contextMenu.showAt(e.getX(), e.getY());",
                    "        e.preventDefault();"
                ],
                "name": "itemcontextmenu",
                "scope": "me"
            },
            "designerId": "f019eb10-373f-4727-92b4-0ea2c6aeae6a"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "tasksToolbar",
                "designer|params": [
                    "toolbar"
                ],
                "designer|targetType": null,
                "fn": "initShowAll",
                "implHandler": [
                    "  toolbar.getComponent('show-all-btn').toggle();"
                ],
                "name": "afterrender",
                "scope": "me"
            },
            "designerId": "2e2524f2-4fbb-4e10-8ca1-703d2d40ede2"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "taskEditWindow [name=has_reminder]",
                "designer|targetType": "Ext.form.field.Checkbox",
                "fn": "toggleReminderFields",
                "implHandler": [
                    " var checkbox = field,",
                    "     taskEditWindow = this.getTaskEditWindow(),",
                    "            windowEl = taskEditWindow.getEl(),",
                    "            form = taskEditWindow.down('form').getForm(),",
                    "            task = form.getRecord(),",
                    "            dateField = form.findField('reminder_date'),",
                    "            timeField = form.findField('reminder_time'),",
                    "            defaultTimeDate, defaultTimeMilliseconds;",
                    "        ",
                    "        if(newValue) { // if the \"has reminder\" checkbox was checked",
                    "            windowEl.mask('loading');",
                    "            // get the default reminder time from the server or cache",
                    "            this.getDefaultReminderTime(function(defaultTime) {",
                    "                // enable the date and time fields",
                    "                dateField.enable();",
                    "                timeField.enable();",
                    "                if(!dateField.getValue()) {",
                    "                    // if the reminder date has not already been set, default the reminder date to the task's due date",
                    "                    // or the current date if the task does not have a due date",
                    "                    dateField.setValue(task.get('due') || Ext.Date.clearTime(new Date()));",
                    "                    timeField.setValue(defaultTime);",
                    "                }",
                    "                // set the form's hidden reminder field by combining the reminder date and time fields",
                    "                defaultTimeDate = timeField.getValue();",
                    "                defaultTimeMilliseconds = defaultTimeDate - Ext.Date.clearTime(defaultTimeDate, true);",
                    "                form.findField('reminder').setValue(new Date(dateField.getValue().getTime() + defaultTimeMilliseconds));",
                    "                windowEl.unmask();",
                    "            });",
                    "        } else { // if the \"has reminder\" checkbox was unchecked",
                    "            // nullify the form's hidden reminder field and disable the reminder date and time fields",
                    "            form.findField('reminder').setValue(null);",
                    "            dateField.disable();",
                    "            timeField.disable();",
                    "        }"
                ],
                "name": "change",
                "scope": "me"
            },
            "designerId": "368948b4-1c0c-476b-b60c-9511f9621957"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#cancel-task-edit-btn",
                "designer|targetType": "Ext.button.Button",
                "fn": "hideEditWindow",
                "implHandler": [
                    "  this.getTaskEditWindow().close();"
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "b85a52b4-0041-4600-af50-6d650f9c5d4d"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#save-task-edit-btn",
                "designer|targetType": "Ext.button.Button",
                "fn": "handleSaveTaskClick",
                "implHandler": [
                    " this.saveEditWindow();"
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "11c75929-11ec-4659-9455-1f310667f0b5"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "taskEditWindow [name=reminder_date]",
                "designer|params": [
                    "field",
                    "oldValue",
                    "newValue"
                ],
                "fn": "syncReminderField",
                "implHandler": [
                    "var form = this.getTaskEditWindow().down('form').getForm(),",
                    "    reminderField = form.findField('reminder'),",
                    "    date = form.findField('reminder_date').getValue(),",
                    "    timeDate = form.findField('reminder_time').getValue(),",
                    "    time, reminderDate;",
                    "",
                    "if(date && timeDate) {",
                    "    time = timeDate - Ext.Date.clearTime(timeDate, true);",
                    "    reminderDate = new Date(date.getTime() + time);",
                    "    reminderField.setValue(reminderDate); ",
                    "}"
                ],
                "name": "change",
                "scope": "me"
            },
            "designerId": "e4658aad-d2f9-419f-bda3-bcf6d10763c4"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "taskEditWindow [name=reminder_time]",
                "designer|params": [
                    "field",
                    "oldValue",
                    "newValue"
                ],
                "fn": "syncReminderFieldAgain",
                "implHandler": [
                    "this.syncReminderField(field, oldValue, newValue);"
                ],
                "name": "change",
                "scope": "me"
            },
            "designerId": "93613f66-a8e1-4357-987f-f8b3c804a223"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#toggle-complete-btn",
                "designer|targetType": "Ext.button.Button",
                "fn": "toggleCompleteField",
                "implHandler": [
                    "   var taskEditWindow = this.getTaskEditWindow(),",
                    "            doneField = taskEditWindow.down('form').getForm().findField('done');",
                    "",
                    "        if(doneField.getValue() === 'true') {",
                    "            doneField.setValue(false);",
                    "        } else {",
                    "            doneField.setValue(true);",
                    "        }",
                    "        this.saveEditWindow();"
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "c47cbfb1-099a-4c7c-a2df-b91f387c0512"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#delete-task-window-btn",
                "designer|targetType": "Ext.button.Button",
                "fn": "deleteTaskAndCloseEditWindow",
                "implHandler": [
                    "    var me = this,",
                    "            taskEditWindow = me.getTaskEditWindow(),",
                    "            task = taskEditWindow.down('form').getRecord();",
                    "",
                    "        me.deleteTask(task, function() {",
                    "            me.getTaskEditWindow().close();",
                    "        });"
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "8ef00e72-777b-41b8-ab80-e115f9f6aff2"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#cancel-default-time-edit-btn",
                "designer|targetType": "Ext.button.Button",
                "fn": "hideDefaultTimeWindow",
                "implHandler": [
                    "   this.getDefaultTimeWindow().close();"
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "8bc24f8a-6a94-44c7-9a59-058a59877d95"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#save-default-time-btn",
                "designer|targetType": "Ext.button.Button",
                "fn": "saveDefaultTime",
                "implHandler": [
                    "  var me = this,",
                    "            defaultTimeWindow = me.getDefaultTimeWindow(),",
                    "            windowEl = defaultTimeWindow.getEl(),",
                    "            time = defaultTimeWindow.down('form').getForm().findField('default_time').getRawValue();",
                    "",
                    "        if (SimpleTasksSettings.useLocalStorage) {",
                    "            localStorage.setItem('SimpleTasks-defaultReminderTime', time);",
                    "            me.defaultReminderTime = time;",
                    "            defaultTimeWindow.close();",
                    "        } else {",
                    "            windowEl.mask('saving');",
                    "            Ext.Ajax.request({",
                    "                url: 'php/config/update.php',",
                    "                params: {",
                    "                    key: 'default.reminder.time',",
                    "                    value: time",
                    "                },",
                    "                success: function(response, eOpts) {",
                    "                    var responseData = Ext.decode(response.responseText);",
                    "",
                    "                    if(responseData.success) {",
                    "                        me.defaultReminderTime = time;",
                    "                        defaultTimeWindow.close();",
                    "                    } else {",
                    "                        Ext.MessageBox.show({",
                    "                            title: 'Set Default Time Failed',",
                    "                            msg: responseData.message,",
                    "                            icon: Ext.Msg.ERROR,",
                    "                            buttons: Ext.Msg.OK",
                    "                        });",
                    "                    }",
                    "                    windowEl.unmask();",
                    "                },",
                    "                failure: function(response, eOpts) {",
                    "                    Ext.MessageBox.show({",
                    "                        title: 'Set Default Time Failed',",
                    "                        msg: response.status + ' ' + response.statusText,",
                    "                        icon: Ext.Msg.ERROR,",
                    "                        buttons: Ext.Msg.OK",
                    "                    });",
                    "                    windowEl.unmask();",
                    "                }",
                    "            });",
                    "        }"
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "63ba697d-467e-4a76-a26e-e4f34e3aa02e"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "[cls=snooze-btn]",
                "designer|targetType": "Ext.button.Button",
                "fn": "snooze",
                "implHandler": [
                    "var reminderWindow = button.findParentByType('window'),",
                    "    task = reminderWindow.getTask(),",
                    "    snoozeMilliseconds = reminderWindow.down('[name=snooze_time]').getValue() * 60000,",
                    "    reminderDate = new Date(new Date().getTime() + snoozeMilliseconds);",
                    "",
                    "task.set('reminder', reminderDate);",
                    "task.save({",
                    "    failure: function(task, operation) {",
                    "        var error = operation.getError(),",
                    "            msg = Ext.isObject(error) ? error.status + ' ' + error.statusText : error;",
                    "",
                    "        Ext.MessageBox.show({",
                    "            title: 'Set Reminder Failed',",
                    "            msg: msg,",
                    "            icon: Ext.Msg.ERROR,",
                    "            buttons: Ext.Msg.OK",
                    "        });",
                    "    }",
                    "});",
                    "reminderWindow.close();"
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "9771ab4b-2dce-4a2b-8245-381bbf6e5b70"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "[cls=dismiss-reminder-btn]",
                "designer|targetType": "Ext.button.Button",
                "fn": "dismissReminder",
                "implHandler": [
                    "  button.findParentByType('window').close();"
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "646102e3-a649-47f9-909c-5feb7ed4376f"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "task",
                    "successCallback"
                ],
                "fn": "deleteTask",
                "implHandler": [
                    "   var me = this;",
                    "        ",
                    "        Ext.Msg.show({",
                    "            title: 'Delete Task?',",
                    "            msg: 'Are you sure you want to delete this task?',",
                    "            buttons: Ext.Msg.YESNO,",
                    "            fn: function(response) {",
                    "                if(response === 'yes') {",
                    "                    task.destroy({",
                    "                        success: function(task, operation) {",
                    "                            me.getTasksStore().remove(task);",
                    "                            me.refreshFiltersAndCount();",
                    "                            if(successCallback) {",
                    "                                successCallback();",
                    "                            }",
                    "                        },",
                    "                        failure: function(task, operation) {",
                    "                            var error = operation.getError(),",
                    "                                msg = Ext.isObject(error) ? error.status + ' ' + error.statusText : error;",
                    "",
                    "                            Ext.MessageBox.show({",
                    "                                title: 'Delete Task Failed',",
                    "                                msg: msg,",
                    "                                icon: Ext.Msg.ERROR,",
                    "                                buttons: Ext.Msg.OK",
                    "                            });",
                    "                        }",
                    "                    });",
                    "                }",
                    "            }",
                    "        });"
                ]
            },
            "designerId": "42f179ee-2cc6-4c22-bd52-e5ac78ed193c"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "newTask",
                "implHandler": [
                    "      var me = this,",
                    "            form = me.getTaskForm(),",
                    "            basicForm = form.getForm(),",
                    "            formEl = form.getEl(),",
                    "            titleField = form.getForm().findField('title'),",
                    "            task = Ext.create('SimpleTasks.model.Task');",
                    "",
                    "        // require title field to have a value",
                    "        if(!titleField.getValue()) {",
                    "            return;",
                    "        }",
                    "",
                    "        // update the new task record with the data from the form.",
                    "        basicForm.updateRecord(task);",
                    "",
                    "        // try to blur all of this form's items to make sure that the user can't type into a field while saving",
                    "        form.items.each(function(item) {",
                    "            var inputEl = item.getEl().down('input')",
                    "            if(inputEl) {",
                    "                inputEl.blur();",
                    "            }",
                    "        });",
                    "",
                    "        // mask the form element while saving",
                    "        formEl.mask('saving . . .');",
                    "        // save the task to the server",
                    "        task.save({",
                    "            success: function(task, operation) {",
                    "                me.getTasksStore().add(task);",
                    "                me.refreshFiltersAndCount();",
                    "                me.getTasksStore().sort();",
                    "                titleField.reset();",
                    "                titleField.focus();",
                    "                formEl.unmask();",
                    "            },",
                    "            failure: function(task, operation) {",
                    "                var error = operation.getError(),",
                    "                    msg = Ext.isObject(error) ? error.status + ' ' + error.statusText : error;",
                    "",
                    "                Ext.MessageBox.show({",
                    "                    title: 'Add Task Failed',",
                    "                    msg: msg,",
                    "                    icon: Ext.Msg.ERROR,",
                    "                    buttons: Ext.Msg.OK",
                    "                });",
                    "                formEl.unmask();",
                    "            }",
                    "        });"
                ]
            },
            "designerId": "3a8ad222-b386-42ac-8ac6-3b4d5f83b174"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "refreshFiltersAndCount",
                "implHandler": [
                    "  // refresh the task filters",
                    "        this.getTaskGrid().refreshFilters();",
                    "        // refresh the lists list view so that the task counts will be correct",
                    "        this.getListTree().refreshView();"
                ]
            },
            "designerId": "045cb1d9-50d0-4ed8-b8de-9858aee44233"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "task"
                ],
                "fn": "showEditWindow",
                "implHandler": [
                    " var me = this,",
                    "            taskEditWindow = me.getTaskEditWindow(),",
                    "            form =  taskEditWindow.down('form').getForm(),",
                    "            reminderCheckbox = form.findField('has_reminder'),",
                    "            dateField = form.findField('reminder_date'),",
                    "            timeField = form.findField('reminder_time'),",
                    "            reminder = task.get('reminder');",
                    "",
                    "        // Set the tasks title as the title of the edit window",
                    "        taskEditWindow.setTitle('Edit Task - ' + task.get('title'));",
                    "        // load the task data into the form",
                    "        taskEditWindow.down('form').loadRecord(task);",
                    "        // set the text of the toggle-complete button depending on the tasks \"done\" value",
                    "        Ext.getCmp('toggle-complete-btn').setText(task.get('done') ? 'Mark Active' : 'Mark Complete');",
                    "        taskEditWindow.show();",
                    "",
                    "        if(task.get('reminder')) {",
                    "            // if the task already has a reminder set check the reminder checkbox and populate the reminder date and reminder time fields",
                    "            reminderCheckbox.setValue(true);",
                    "            dateField.setValue(Ext.Date.clearTime(reminder, true));",
                    "            timeField.setValue(Ext.Date.format(reminder, timeField.format)); ",
                    "        } else {",
                    "            // if the task does not have a reminder set uncheck the reminder checkbox and set the reminder date and time fields to null",
                    "            reminderCheckbox.setValue(false);",
                    "            dateField.setValue(null);",
                    "            timeField.setValue(null); ",
                    "        }",
                    "",
                    "        if(task.get('done')) {",
                    "            // if the task is done disable the reminder checkbox (reminders cannot be set on completed tasks)",
                    "            reminderCheckbox.disable();",
                    "        } else {",
                    "            reminderCheckbox.enable();",
                    "        }",
                    ""
                ]
            },
            "designerId": "2666dbf4-989d-43bf-95d2-98dacf03c466"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "saveEditWindow",
                "implHandler": [
                    "  var taskEditWindow = this.getTaskEditWindow(),",
                    "            windowEl = taskEditWindow.getEl(),",
                    "            form = taskEditWindow.down('form').getForm(),",
                    "            task = form.getRecord();",
                    "",
                    "        if(form.isValid()) {",
                    "            windowEl.mask('saving');",
                    "            form.updateRecord(task);",
                    "            if(task.modified.done === false) {",
                    "                task.set('reminder', null);",
                    "            }",
                    "            task.save({",
                    "                success: function(task, operation) {",
                    "                    windowEl.unmask();",
                    "                    taskEditWindow.close();",
                    "                },",
                    "                failure: function(task, operation) {",
                    "                    var error = operation.getError(),",
                    "                       msg = Ext.isObject(error) ? error.status + ' ' + error.statusText : error;",
                    "",
                    "                    Ext.MessageBox.show({",
                    "                        title: 'Edit Task Failed',",
                    "                        msg: msg,",
                    "                        icon: Ext.Msg.ERROR,",
                    "                        buttons: Ext.Msg.OK",
                    "                    });",
                    "                    windowEl.unmask();",
                    "                }",
                    "            })",
                    "        } else {",
                    "            Ext.Msg.alert('Invalid Data', 'Please correct form errors');",
                    "        }"
                ]
            },
            "designerId": "c2f4a209-9ab4-435c-8620-fda2ff5bd74c"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "callback"
                ],
                "fn": "getDefaultReminderTime",
                "implHandler": [
                    "var me = this,",
                    "    defaultReminderTime;",
                    "",
                    "if(me.defaultReminderTime) {",
                    "    callback(me.defaultReminderTime);",
                    "} else {",
                    "    me.defaultReminderTime = '8:00 AM'; // the default time if no value can be retrieved from storage",
                    "    if (SimpleTasksSettings.useLocalStorage) {",
                    "        defaultReminderTime = localStorage.getItem('SimpleTasks-defaultReminderTime');",
                    "        if (defaultReminderTime) {",
                    "            me.defaultReminderTime = defaultReminderTime;",
                    "        }",
                    "        callback(me.defaultReminderTime);",
                    "    } else {",
                    "        console.log('not supposed to be here');",
                    "        Ext.Ajax.request({",
                    "            url: 'php/config/read.php',",
                    "            params: {",
                    "                key: 'default.reminder.time'",
                    "            },",
                    "            success: function(response, options) {",
                    "                var responseData = Ext.decode(response.responseText);",
                    "                if(responseData.success && responseData.value) {",
                    "                    me.defaultReminderTime = responseData.value;",
                    "                }",
                    "                callback(me.defaultReminderTime);",
                    "            },",
                    "            failure: function(response, options) {",
                    "                callback(me.defaultReminderTime);",
                    "            }",
                    "        });",
                    "    }",
                    "}"
                ]
            },
            "designerId": "11a6a3a1-9f7f-43e6-8489-dd096a4edd38"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "initReminderInterval",
                "implHandler": [
                    "  var me = this,",
                    "            now, reminderDate;",
                    "",
                    "        setInterval(function() {",
                    "            now = new Date();",
                    "            me.getTasksStore().each(function(task) {",
                    "                reminderDate = task.get('reminder');",
                    "                if(reminderDate && reminderDate < now && !task.get('done')) {",
                    "                    me.showReminderWindow(task);",
                    "                }",
                    "            });",
                    "        }, 10000);"
                ]
            },
            "designerId": "d58ce96f-548a-49c7-bb9b-b4336b85b8db"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "task"
                ],
                "fn": "showReminderWindow",
                "implHandler": [
                    "var reminderWindow = this.getReminderWindow(),",
                    "    reminderDetailsBox = reminderWindow.down('[cls=tasks-reminder-details]'),",
                    "    title = task.get('title');",
                    "",
                    "task.set('reminder', null);",
                    "task.save({",
                    "    failure: function(task, operation) {",
                    "        var error = operation.getError(),",
                    "            msg = Ext.isObject(error) ? error.status + ' ' + error.statusText : error;",
                    "",
                    "        Ext.MessageBox.show({",
                    "            title: 'Clear Reminder Failed',",
                    "            msg: msg,",
                    "            icon: Ext.Msg.ERROR,",
                    "            buttons: Ext.Msg.OK",
                    "        });",
                    "    }",
                    "});",
                    "reminderWindow.setTask(task);",
                    "reminderWindow.setTitle('Reminder - ' + title);",
                    "reminderDetailsBox.update({",
                    "    title: title,",
                    "    due: task.get('due')",
                    "});",
                    "reminderWindow.show();"
                ]
            },
            "designerId": "6f2d3117-b56b-49b1-8185-83f83889e3ac"
        }
    ]
}